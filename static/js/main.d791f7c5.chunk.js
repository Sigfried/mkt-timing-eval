(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(t,e,a){"use strict";a.d(e,"a",function(){return h});var n=a(5),r=a(6),c=a(8),o=a(7),i=a(9),s=a(0),l=a.n(s),u=a(1),d=(a(2),{textAlign:"left",color:"darkgreen",marginLeft:20,marginTop:100}),h=function(t){function e(t){var a;return Object(n.a)(this,e),(a=Object(c.a)(this,Object(o.a)(e).call(this,t))).state={drewChart:!1},a.gRef=l.a.createRef(),a}return Object(i.a)(e,t),Object(r.a)(e,[{key:"componentDidMount",value:function(){var t=this.props;t.sym,t.data;this.setup({},{})}},{key:"componentDidUpdate",value:function(t,e){this.setup(t,e)}},{key:"setup",value:function(t,e){var a=this.props,n=(a.sym,a.data),r=this.state.drewChart;if(n&&this.gRef.current&&(!r||n!==t.data)){var c=u.select(this.gRef.current);(this.chartSetup(c)||function(){})(n),this.setState({drewChart:!0})}}},{key:"render",value:function(){var t=this.props,e=t.sym,a=(t.data,t.type);t.title;return l.a.createElement("g",{id:"".concat(e,"-").concat(a),ref:this.gRef,style:d})}},{key:"chartSetup",value:function(t){var e=this.props,a=(e.sym,e.data),n=(e.type,e.width),r=e.height,c=e.xScale,o=e.yScale,i=e.title,s=e.doToChart;try{var l=u.axisBottom(c);t.append("g").attr("class","x axis x-axis").attr("transform","translate(0,".concat(r,")")).call(l)}catch(h){console.log(h)}var d=u.axisRight(o).ticks(3);t.append("g").attr("class","y axis y-axis").attr("transform","translate(0,0)").call(d),p(t,n,r,i),s(t,a,c,o)}}]),e}(s.Component),p=function(t,e,a,n){var r=t.append("svg").attr("width",e).attr("height",a-50),c=[u.rgb("#ff00ea"),u.rgb("#5201a8")],o=n.includes("+")?n.split("+"):[n],i=r.selectAll(".legends4").data(o).enter().append("g").attr("class","legends4").attr("transform",function(t,e){if(0===e)return t.length+150,"translate(30,2)";return t.length+150,"translate(".concat(t.length+150*e,", 2)")});i.append("rect").attr("x",0).attr("y",0).attr("width",10).attr("height",10).style("fill",function(t,e){return c[e]}),i.append("text").attr("x",20).attr("y",10).text(function(t,e){return t}).attr("class","textselected").style("text-anchor","start").style("font-size",15)}},153:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),c=a(47),o=a.n(c),i=(a(58),a(5)),s=a(6),l=a(8),u=a(7),d=a(9),h=(a(59),a(48)),p=function(t){function e(){return Object(i.a)(this,e),Object(l.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(h.a,null))}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(p,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},48:function(t,e,a){"use strict";(function(t){a.d(e,"a",function(){return L});var n=a(10),r=a(5),c=a(6),o=a(8),i=a(7),s=a(9),l=(a(51),a(52)),u=a(0),d=a.n(u),h=a(1),p=a(49),f=a.n(p),m=a(50),y=a.n(m),v=a(2),g=a.n(v),b=a(14);window.d3=h;var x=h.timeFormat("%m/%d/%Y"),k=h.format(","),C=function(t){return t};window.global={status:null,datasets:{}};var w=new CustomEvent("dataReady",t);Promise.all([h.csv(f.a),h.csv(y.a)]).then(function(e){var a=Object(l.a)(e,2),n=a[0],r=a[1];t.status="ready",t.datasets={daily:n,dcadaily:r},document.dispatchEvent(w)});var S={x:function(t){return t.date},y0:function(t){return t.curcost},y1:function(t){return t.curval},date:function(t){return t.date},curcost:function(t){return t.curcost},curval:function(t){return t.curval},price:function(t){return t.price},curpl:function(t){return t.curpl},close:function(t){return t.close},realpl:function(t){return t.realpl},symbol:function(t){return t.symbol}},D=function(t){t=t.map(function(t){return t.date=new Date(t.date),t.Price=parseFloat(t.Price),t.price=t.Price,t.Quantity=parseFloat(t.Quantity),t.close=parseFloat(t.close),t.curcost=parseFloat(t.curcost),t.curval=parseFloat(t.curval),t.curpl=parseFloat(t.curpl),t.pos=parseFloat(t.pos),t.trdnum=parseInt(t.trdnum),t});var e=g.a.supergroup(t,"symbol").sort();return C&&(e=C(e)),E(e,O),{daily:t=e.flatMap(function(t){return t.records}),bysym:e,accessors:S}},E=function(t,e){return t.forEach(function(t){t.records=e(t)}),t},O=function(t){var e=t.records.filter(function(t){return"NA"!==t.Action});j(e);var a=0;return t.records.map(function(t){return"undefined"!==typeof t.closingPL&&(a+=t.closingPL),t.realpl=a,t})},j=function(t){t.reduce(function(t,e,a,n){return"buy"===e.Action?t.push(e):e.closingPL=M(t,e),t},[])},M=function(t,e){for(var a=-e.Quantity,n=0;a;){if(a<0)throw new Error("that's not supposed to happen");var r=t.pop();if(r.Quantity>a){var c=g.a.cloneDeep(r);c.Quantity-=a,t.push(c),r.Quantity=a}n+=r.Quantity*e.Price-r.Quantity*r.Price,a-=r.Quantity}return n},P=function(){return{width:.45*{width:.9*window.innerWidth}.width}},L=function(e){function a(t){var e;return Object(r.a)(this,a),(e=Object(o.a)(this,Object(i.a)(a).call(this,t))).state={},e}return Object(s.a)(a,e),Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("dataReady",function(a){return e.setState({global:t})})}},{key:"componentDidUpdate",value:function(t,e){this.handleData(t,e)}},{key:"handleData",value:function(t,e){var a=g.a.get(this.state,"global.status"),n=g.a.get(this.state,"global.datasets");"ready"===a&&n!==g.a.get(e,"global.datasets")&&this.setState({status:a,datasets:n})}},{key:"render",value:function(){return"ready"!==this.state.status?null:d.a.createElement(N,{datasets:this.state.datasets})}}]),a}(u.Component),N=function(t){function e(t){var a;return Object(r.a)(this,e),(a=Object(o.a)(this,Object(i.a)(e).call(this,t))).state={},a}return Object(s.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){this.handleData({},{})}},{key:"componentDidUpdate",value:function(t,e){this.handleData(t,e)}},{key:"handleData",value:function(t,e){var a=this.props.datasets;if(a!==t.datasets){var n=g.a.mapValues(a,function(t,e){var a=function(t,e){var a=P(),n=D(t),r=n.daily,c=n.bysym,o=n.accessors,i={cgcName:e,width:a.width,daily:r,bysym:c,accessors:o};return window.global[e]={conf:i},i}(t,e),n=a.cgcName,r=(a.daily,a.bysym),c=a.accessors,o=(a.width,r.map(function(t){return g.a.last(t.records)}));o=g.a.sortBy(o,function(t){return t.realpl});var i={Symbol:function(t){return c.symbol(t)},"P&L":function(t){return Math.floor(c.curpl(t))},Gains:function(t){return Math.floor(c.realpl(t))},Value:function(t){return Math.floor(c.curval(t))},Cost:function(t){return Math.floor(c.curcost(t))},Close:function(t){return Math.floor(c.close(t))}},s=g.a.keys(i),l=d.a.createElement("div",{className:"hovtbl"},d.a.createElement("div",{className:"hovwrapper"},s.map(function(t,e){return d.a.createElement("div",{key:e,style:{gridColumn:e+1}},t)})),o.map(function(t,e){var a=function(t){return g.a.map(i,function(e,a){return e(t)})}(t);return d.a.createElement("div",{key:e,style:{display:"grid",gridTemplateColumns:"repeat(".concat(s.length,", 1fr)")}},a.map(function(t,e){return d.a.createElement("div",{key:e,style:{gridColumn:e+1}},isFinite(t)?k(t):t)}))})),u=r.map(function(t){var e="".concat(n,"-").concat(t);return d.a.createElement("div",{key:e},d.a.createElement("h4",null,t+""),d.a.createElement(A,{sym:t,cgcData:a}))});return d.a.createElement("div",{key:n,className:"chart-group-col ".concat(n)},d.a.createElement("h2",null,r.length," symbols, ",n),l,u)});this.setState({chartGroupCols:n})}}},{key:"render",value:function(){var t=this.state.chartGroupCols,e=void 0===t?{}:t;return d.a.createElement("div",null,g.a.values(e))}}]),e}(u.Component),A=function(t){function e(t){var a;return Object(r.a)(this,e),(a=Object(o.a)(this,Object(i.a)(e).call(this,t))).state={drewChart:!1,hoverMsg:""},a.leaveChart=a.leaveChart.bind(Object(n.a)(Object(n.a)(a))),a.hoverChart=a.hoverChart.bind(Object(n.a)(Object(n.a)(a))),a}return Object(s.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){this.handleData({},{})}},{key:"componentDidUpdate",value:function(t,e){var a=this.state,n=(a.drewChart,a.selectedDate);if(n&&n!==e.selectedDate){var r=this.props,c=(r.sym,r.cgcData);c.cgcName,c.daily,c.bysym,c.accessors,c.width;this.setSelectedDate(n)}else this.handleData(t,e)}},{key:"handleData",value:function(t,e){var a=this.props.sym,n=this.state,r=n.drewChart;n.selectedDate;if(!r)return this.makeSvg(),void this.setState({drewChart:!0});a===t.sym||this.makeSvg()}},{key:"leaveChart",value:function(t){var e=this.state.cgCharts.xScale.domain()[1];this.setSelectedDate(e)}},{key:"hoverChart",value:function(t){var e=this.state.cgCharts.xScale.invert(t.clientX);this.setSelectedDate(e)}},{key:"setSelectedDate",value:function(t){var e=this.props,a=e.sym,n=e.cgcData.accessors,r=a.records.find(function(e){return n.date(e).toLocaleDateString()===t.toLocaleDateString()});if(r){var c=this.state.cgCharts,o=c.xScale;c.cgHeight,c.cHeight,c.margin,c.height;c.forEach(function(e){var a=e.yScale,c=e.ckey;h.select("circle#trade-dot-".concat(c)).attr("cx",o(t)).attr("cy",a(n[e.fixedProps.type](r)))}),this.setState({hoverMsg:"".concat(x(n.date(r)),"\n          P&L: $").concat(Math.floor(n.curpl(r))," Gains: $").concat(Math.floor(n.realpl(r))," Value: $").concat(Math.floor(n.curval(r))," Cost: $").concat(Math.floor(n.curcost(r)),"  Close: $").concat(Math.floor(n.close(r)))})}}},{key:"makeCgCharts",value:function(){var t=this.props,e=t.sym,a=t.cgcData,n=(a.cgcName,a.daily,a.accessors),r=a.width,c=h.scaleTime().range([0,r]).domain(h.extent(e.records.map(n.x))),o=[{Comp:b.a,fixedProps:{xScale:c,title:"Current value - current cost (unrealized P&L)",type:"curpl",makeYScale:function(t,e,a){return h.scaleLinear().range([t,0]).domain(h.extent(e.map(a.curpl)))},doToChart:function(t,e,a,r){var c=h.line().x(function(t){return a(n.date(t))}).y(function(t){return r(n.curpl(t))});t.append("path").data([e]).attr("class","blue").attr("d",c)}}},{Comp:b.a,fixedProps:{xScale:c,title:"Realized P&L",type:"realpl",makeYScale:function(t,e,a){return h.scaleLinear().range([t,0]).domain(h.extent(e.map(a.realpl)))},doToChart:function(t,e,a,r){var c=h.line().x(function(t){return a(n.date(t))}).y(function(t){return r(n.realpl(t))});t.append("path").data([e]).attr("stroke","purple").attr("stroke-width",3).attr("d",c)}}},{Comp:b.a,fixedProps:{xScale:c,title:"Current cost + Current value",type:"curval",description:"\n            current value = current position * current price;\n            current cost = cost of shares bought - cost of shares sold\n          ",makeYScale:function(t,e){return h.scaleLinear().range([t,0]).domain(h.extent(e.map(n.y0).concat(e.map(n.y1))))},doToChart:function(t,e,a,r){h.area().x(function(t){return a(n.date(t))}).y0(function(t){return r(-n.curcost(t))}).y1(function(t){return r(n.curval(t))});var c=h.line().x(function(t){return a(n.date(t))}).y(function(t){return r(n.curval(t))}),o=h.line().x(function(t){return a(n.date(t))}).y(function(t){return r(-n.curcost(t))});t.append("path").data([e]).attr("class","blue").attr("d",c),t.append("path").data([e]).attr("class","red").attr("d",o)}}},{Comp:b.a,fixedProps:{xScale:c,title:"daily closing price",type:"close",makeYScale:function(t,e,a){return h.scaleLinear().range([t,0]).domain([0,h.max(e.map(a.close))])},doToChart:function(t,e,a,r){var c=h.line().x(function(t){return a(n.date(t))}).y(function(t){return r(n.close(t))});t.append("path").data([e]).attr("class","blue").attr("d",c)}}}];return o.xScale=c,o}},{key:"tradeLines",value:function(t){var e=t.cgCharts,a=e.cgHeight,n=(e.yScale,e.xScale),r=this.props,c=r.sym,o=r.cgcData,i=(o.cgcName,o.daily,o.accessors,c.records.filter(function(t){return"NA"!==t.Action}));return d.a.createElement("g",null,i.map(function(t,e){return d.a.createElement("g",{key:e,transform:"translate(".concat(n(t.date),", 0)")},d.a.createElement("line",{x1:0,x2:0,y1:0,y2:a,className:"trade-line ".concat(t.Action)}))}))}},{key:"makeSvg",value:function(){var t=this.props,e=t.sym,a=t.cgcData;if(e){var n=e.records,r=a.cgcName,c=(a.daily,a.accessors),o=a.width,i=this.makeCgCharts(),s=i.xScale.domain()[1],l=500/i.length,u="".concat(r,"-").concat(e),h={top:20,right:20,bottom:30,left:50},p=l-h.top-h.bottom;o=o-h.left-h.right,Object.assign(i,{cgHeight:500,cHeight:l,key:u,margin:h,height:p,width:o});var f=i.map(function(t,a){var r="".concat(u,"-").concat(t.fixedProps.type),i=t.fixedProps.makeYScale(p,n,c);return t.ckey=r,t.yScale=i,d.a.createElement("g",{key:r,className:"chart",transform:"translate(0, ".concat(l*a,")")},d.a.createElement(t.Comp,Object.assign({},t.fixedProps,{sym:e+"",data:n,width:o,height:p,yScale:i})),d.a.createElement("line",{x1:0,x2:o+h.left+h.right,y1:i(0),y2:i(0),className:"zero"}),d.a.createElement("circle",{id:"trade-dot-".concat(r),cx:-100,cy:-100,stroke:"green",strokeWidth:"3px",fillOpacity:.5,fill:"white",r:8}))}),m=d.a.createElement("svg",{key:u,width:o+h.left+h.right,height:500,onMouseLeave:this.leaveChart,onMouseMove:this.hoverChart},this.tradeLines({cgCharts:i}),f);this.setState({svg:m,selectedDate:s,cgCharts:i})}}},{key:"render",value:function(){var t=this.props.cgcData,e=(t.daily,t.accessors,t.width,t.height,this.state),a=e.svg,n=void 0===a?null:a,r=e.hoverMsg;e.selectedDate;return d.a.createElement("div",{className:"chart-group"},d.a.createElement("div",{className:"info-box"},r),n)}}]),e}(u.Component)}).call(this,a(15))},49:function(t,e,a){t.exports=a.p+"static/media/daily.343f2f78.csv"},50:function(t,e,a){t.exports=a.p+"static/media/dcadaily.884b3528.csv"},53:function(t,e,a){t.exports=a(153)},58:function(t,e,a){},59:function(t,e,a){}},[[53,1,2]]]);
//# sourceMappingURL=main.d791f7c5.chunk.js.map